<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SenaParkControl - Sistema de Parqueaderos</title>
    <link rel="stylesheet" href="./styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lucide/1.28.0/font/lucide.min.css">
</head>
<body>
    <!-- Layout Principal -->
    <div id="main-app" class="min-h-screen flex flex-col bg-gray-50">
        <!-- Navbar -->
        <header class="bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm">
            <div class="container">
                <div class="flex items-center justify-between h-16">
                    <!-- Logo -->
                    <a href="#" onclick="showHome()" class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-green-600 to-green-700 rounded-lg flex items-center justify-center">
                            <i data-lucide="car" class="w-6 h-6 text-white"></i>
                        </div>
                        <div class="flex flex-col">
                            <span class="font-semibold text-gray-900">SenaParkControl</span>
                            <span class="text-xs text-gray-500">Sistema de Parqueaderos</span>
                        </div>
                    </a>

                    <!-- Navigation Menu (visible when logged in) -->
                    <nav id="main-nav" class="hidden md:flex items-center space-x-1">
                        <!-- Navigation links will be added dynamically when user logs in -->
                    </nav>

                    <!-- Right side buttons -->
                    <div class="flex items-center space-x-3">
                        <div id="guest-buttons">
                            <button onclick="showLogin()" class="btn btn-ghost">Iniciar Sesi√≥n</button>
                            <button onclick="showRegister()" class="btn btn-primary">Registrarse</button>
                        </div>
                        
                        <div id="user-menu" class="hidden">
                            <div class="dropdown">
                                <button class="btn btn-ghost relative h-10 w-10 rounded-full" id="user-menu-button">
                                    <div class="avatar" id="user-avatar">
                                        <!-- Avatar content will be added dynamically -->
                                    </div>
                                </button>
                                <div class="dropdown-content hidden" id="user-dropdown">
                                    <div class="p-4 border-b border-gray-100">
                                        <p id="user-name" class="font-medium"></p>
                                        <p id="user-email" class="text-xs text-gray-500"></p>
                                        <div class="badge mt-2" id="user-role-badge">
                                            <!-- Role badge will be added dynamically -->
                                        </div>
                                    </div>
                                    <a href="#" class="dropdown-item">
                                        <i data-lucide="user" class="w-4 h-4 mr-2"></i>
                                        Mi Perfil
                                    </a>
                                    <a href="#" class="dropdown-item">
                                        <i data-lucide="settings" class="w-4 h-4 mr-2"></i>
                                        Configuraci√≥n
                                    </a>
                                    <div class="border-t border-gray-100 my-1"></div>
                                    <a href="#" class="dropdown-item text-red-600" id="logout-button">
                                        <i data-lucide="log-out" class="w-4 h-4 mr-2"></i>
                                        Cerrar Sesi√≥n
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1">
            <!-- Home Page Content -->
            <div id="home-page">
                <!-- Hero Section -->
                <section class="relative bg-gradient-to-br from-green-600 via-green-700 to-green-800 text-white">
                    <div class="container py-8 md:py-12">
                        <div class="grid md:grid-cols-2 gap-6 items-center">
                            <div>
                                <div class="inline-flex items-center space-x-2 bg-white/10 backdrop-blur-sm px-3 py-1 rounded-full mb-4">
                                    <span class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
                                    <span class="text-sm">Sistema Institucional SENA</span>
                                </div>
                                <h1 class="text-2xl md:text-3xl font-bold mb-4">
                                    Gesti√≥n Inteligente de Parqueaderos
                                </h1>
                                <p class="text-sm text-green-50 mb-6 max-w-lg">
                                    Control total de entradas, salidas y registro de veh√≠culos para la comunidad educativa del SENA. 
                                    Seguridad, eficiencia y tecnolog√≠a en un solo lugar.
                                </p>
                                <div class="flex flex-col sm:flex-row gap-3">
                                    <button onclick="showRegister()" class="btn btn-primary bg-white text-green-700 hover:bg-green-50 inline-flex items-center">
                                        Comenzar Ahora
                                        <i data-lucide="arrow-right" class="ml-2 w-4 h-4"></i>
                                    </button>
                                    <a href="#features" class="btn btn-outline border-white text-white hover:bg-white/10">
                                        Conocer M√°s
                                    </a>
                                </div>
                                <div class="flex items-center space-x-6 mt-6">
                                    <div>
                                        <div class="text-2xl font-bold">500+</div>
                                        <div class="text-green-100 text-xs">Veh√≠culos Registrados</div>
                                    </div>
                                    <div>
                                        <div class="text-2xl font-bold">24/7</div>
                                        <div class="text-green-100 text-xs">Monitoreo Activo</div>
                                    </div>
                                    <div>
                                        <div class="text-2xl font-bold">99%</div>
                                        <div class="text-green-100 text-xs">Disponibilidad</div>
                                    </div>
                                </div>
                            </div>
                            <div class="hidden md:block">
                                <!-- Placeholder for an image or illustration -->
                                <div class="bg-white/10 rounded-xl h-64 flex items-center justify-center">
                                    <i data-lucide="car" class="w-24 h-24 text-white/30"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Features Section -->
                <section id="features" class="section bg-gray-50">
                    <div class="container">
                        <div class="text-center mb-8">
                            <h2 class="text-xl md:text-2xl font-bold mb-2">Caracter√≠sticas Principales</h2>
                            <p class="text-sm text-gray-600 max-w-2xl mx-auto">
                                Todo lo que necesitas para gestionar el parqueadero de tu instituci√≥n
                            </p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <!-- Feature 1 -->
                            <div class="card border-2 hover:border-green-500 transition-colors">
                                <div class="p-4">
                                    <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mb-3">
                                        <i data-lucide="car" class="w-5 h-5 text-green-600"></i>
                                    </div>
                                    <h3 class="font-medium mb-2">Registro de Veh√≠culos</h3>
                                    <p class="text-gray-600 text-sm">
                                        Registra y gestiona todos los veh√≠culos de estudiantes, instructores y visitantes.
                                    </p>
                                </div>
                            </div>

                            <!-- Feature 2 -->
                            <div class="card border-2 hover:border-green-500 transition-colors">
                                <div class="p-4">
                                    <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mb-3">
                                        <i data-lucide="clock" class="w-5 h-5 text-orange-600"></i>
                                    </div>
                                    <h3 class="font-medium mb-2">Control de Acceso</h3>
                                    <p class="text-gray-600 text-sm">
                                        Registra entradas y salidas en tiempo real con validaci√≥n autom√°tica de permisos.
                                    </p>
                                </div>
                            </div>

                            <!-- Feature 3 -->
                            <div class="card border-2 hover:border-green-500 transition-colors">
                                <div class="p-4">
                                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mb-3">
                                        <i data-lucide="bar-chart-3" class="w-5 h-5 text-blue-600"></i>
                                    </div>
                                    <h3 class="font-medium mb-2">Reportes Detallados</h3>
                                    <p class="text-gray-600 text-sm">
                                        Genera reportes y estad√≠sticas completas sobre el uso del parqueadero.
                                    </p>
                                </div>
                            </div>

                            <!-- Feature 4 -->
                            <div class="card border-2 hover:border-green-500 transition-colors">
                                <div class="p-4">
                                    <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mb-3">
                                        <i data-lucide="shield" class="w-5 h-5 text-purple-600"></i>
                                    </div>
                                    <h3 class="font-medium mb-2">Seguridad Total</h3>
                                    <p class="text-gray-600 text-sm">
                                        Protege tu instituci√≥n con un sistema de seguridad robusto y confiable.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Resto de las secciones (How it Works, Benefits, Roles, CTA) -->
                <!-- ... (mantener igual que antes) ... -->

            </div>

            <!-- Login Page Content -->
            <div id="login-page" class="hidden">
                <section class="login-section">
                    <a href="#" onclick="showHome()" class="login-back-button">
                        <i data-lucide="arrow-left" class="w-4 h-4"></i>
                        Volver al inicio
                    </a>
                    
                    <div class="login-container">
                        <div class="login-card">
                            <div class="text-center mb-6">
                                <div class="w-16 h-16 bg-gradient-to-br from-green-600 to-green-700 rounded-lg flex items-center justify-center mx-auto mb-4">
                                    <i data-lucide="car" class="w-8 h-8 text-white"></i>
                                </div>
                                <h1 class="text-2xl font-bold text-gray-900 mb-2">Iniciar Sesi√≥n</h1>
                                <p class="text-gray-600 text-sm">Ingresa a tu cuenta de SenaParkControl</p>
                            </div>

                            <form id="login-form">
                                <div id="login-alert" class="alert hidden"></div>
                                
                                <div class="form-group">
                                    <label for="email" class="form-label">Correo Electr√≥nico</label>
                                    <input type="email" id="email" class="form-input" placeholder="usuario@sena.edu.co" required>
                                </div>

                                <div class="form-group">
                                    <label for="password" class="form-label">Contrase√±a</label>
                                    <input type="password" id="password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                                </div>

                                <div class="flex items-center justify-between mb-6">
                                    <div class="flex items-center">
                                        <input type="checkbox" id="remember" class="w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500">
                                        <label for="remember" class="ml-2 text-sm text-gray-700">Recordarme</label>
                                    </div>
                                    <a href="#" class="text-sm text-green-600 hover:text-green-500">¬øOlvidaste tu contrase√±a?</a>
                                </div>

                                <button type="button" class="btn btn-primary w-full" id="login-submit-btn">
                                    Iniciar Sesi√≥n
                                </button>
                            </form>

                            <div class="mt-6 text-center">
                                <p class="text-sm text-gray-600">
                                    ¬øNo tienes una cuenta? 
                                    <a href="#" onclick="showRegister()" class="text-green-600 hover:text-green-500 font-medium">Reg√≠strate aqu√≠</a>
                                </p>
                            </div>

                            <!-- Demo credentials -->
                            <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                                <h3 class="text-sm font-medium text-gray-900 mb-2">Credenciales de demostraci√≥n:</h3>
                                <div class="space-y-1 text-xs text-gray-600">
                                    <div><strong>Estudiante:</strong> estudiante@sena.edu.co / password</div>
                                    <div><strong>Instructor:</strong> instructor@sena.edu.co / password</div>
                                    <div><strong>Guardia:</strong> guardia@sena.edu.co / password</div>
                                    <div><strong>Administrador:</strong> admin@sena.edu.co / password</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Register Page Content -->
            <div id="register-page" class="hidden">
                <section class="login-section">
                    <a href="#" onclick="showHome()" class="login-back-button">
                        <i data-lucide="arrow-left" class="w-4 h-4"></i>
                        Volver al inicio
                    </a>
                    
                    <div class="login-container">
                        <div class="login-card">
                            <div class="text-center mb-6">
                                <div class="w-16 h-16 bg-gradient-to-br from-green-600 to-green-700 rounded-lg flex items-center justify-center mx-auto mb-4">
                                    <i data-lucide="user-plus" class="w-8 h-8 text-white"></i>
                                </div>
                                <h1 class="text-2xl font-bold text-gray-900 mb-2">Crear Cuenta</h1>
                                <p class="text-gray-600 text-sm">Reg√≠strate en SenaParkControl</p>
                            </div>

                            <form id="register-form">
                                <div id="register-alert" class="alert hidden"></div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label for="register-nombre" class="form-label">Nombre Completo *</label>
                                        <input type="text" id="register-nombre" class="form-input" placeholder="Juan P√©rez" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="register-documento" class="form-label">Documento *</label>
                                        <input type="text" id="register-documento" class="form-input" placeholder="123456789" required>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="register-email" class="form-label">Correo Electr√≥nico *</label>
                                    <input type="email" id="register-email" class="form-input" placeholder="usuario@sena.edu.co" required>
                                </div>

                                <div class="form-group">
                                    <label for="register-telefono" class="form-label">Tel√©fono</label>
                                    <input type="tel" id="register-telefono" class="form-input" placeholder="3001234567">
                                </div>

                                <div class="form-group">
                                    <label for="register-rol" class="form-label">Rol *</label>
                                    <select id="register-rol" class="form-input" required>
                                        <option value="">Selecciona tu rol</option>
                                        <option value="3">Estudiante (Aprendiz)</option>
                                        <option value="2">Instructor</option>
                                        <option value="5">Guardia (Vigilante)</option>
                                        <option value="4">Visitante</option>
                                    </select>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="form-group">
                                        <label for="register-password" class="form-label">Contrase√±a *</label>
                                        <input type="password" id="register-password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="register-confirm-password" class="form-label">Confirmar Contrase√±a *</label>
                                        <input type="password" id="register-confirm-password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                                    </div>
                                </div>

                                <div class="flex items-center mb-6">
                                    <input type="checkbox" id="terms" class="w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500" required>
                                    <label for="terms" class="ml-2 text-sm text-gray-700">
                                        Acepto los <a href="#" class="text-green-600 hover:text-green-500">t√©rminos y condiciones</a>
                                    </label>
                                </div>

                                <button type="button" class="btn btn-primary w-full" id="register-submit-btn">
                                    Crear Cuenta
                                </button>
                            </form>

                            <div class="mt-6 text-center">
                                <p class="text-sm text-gray-600">
                                    ¬øYa tienes una cuenta? 
                                    <a href="#" onclick="showLogin()" class="text-green-600 hover:text-green-500 font-medium">Inicia sesi√≥n aqu√≠</a>
                                </p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-900 text-gray-300">
            <div class="container py-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <!-- About -->
                    <div class="col-span-1 md:col-span-2">
                        <div class="flex items-center space-x-3 mb-3">
                            <div class="w-10 h-10 bg-gradient-to-br from-green-600 to-green-700 rounded-lg flex items-center justify-center">
                                <i data-lucide="car" class="w-6 h-6 text-white"></i>
                            </div>
                            <span class="font-semibold text-white">SenaParkControl</span>
                        </div>
                        <p class="text-sm mb-3">
                            Sistema de Gesti√≥n de Parqueaderos del Servicio Nacional de Aprendizaje - SENA. 
                            Innovaci√≥n y tecnolog√≠a al servicio de la comunidad educativa.
                        </p>
                        <div class="flex items-center space-x-2 text-sm">
                            <span class="text-orange-500">üü¢</span>
                            <span>Alison y Rosalinda</span>
                        </div>
                    </div>

                    <!-- Quick Links -->
                    <div>
                        <h3 class="text-white font-semibold mb-3">Enlaces R√°pidos</h3>
                        <ul class="space-y-2 text-sm">
                            <li><a href="#" onclick="showHome()" class="hover:text-white transition-colors">Inicio</a></li>
                            <li><a href="#" onclick="showLogin()" class="hover:text-white transition-colors">Iniciar Sesi√≥n</a></li>
                            <li><a href="#" onclick="showRegister()" class="hover:text-white transition-colors">Registrarse</a></li>
                            <li><a href="#" class="hover:text-white transition-colors">Documentaci√≥n</a></li>
                        </ul>
                    </div>

                    <!-- Contact -->
                    <div>
                        <h3 class="text-white font-semibold mb-3">Contacto</h3>
                        <ul class="space-y-2 text-sm">
                            <li>L√≠nea Nacional: 5925555</li>
                            <li>servicioalciudadano@sena.edu.co</li>
                            <li>Calle 57 No. 8 - 69 Bogot√° D.C.</li>
                        </ul>
                    </div>
                </div>

                <div class="border-t border-gray-800 mt-6 pt-6 flex flex-col md:flex-row justify-between items-center text-sm">
                    <p>&copy; 2025 SENA - Todos los derechos reservados</p>
                    <div class="flex space-x-6 mt-4 md:mt-0">
                        <a href="#" class="hover:text-white transition-colors">T√©rminos de Uso</a>
                        <a href="#" class="hover:text-white transition-colors">Pol√≠tica de Privacidad</a>
                        <a href="#" class="hover:text-white transition-colors">Accesibilidad</a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- SCRIPTS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/1.28.0/lucide.min.js"></script>
    <script>
        console.log('üîß INICIANDO APLICACI√ìN...');
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DOM completamente cargado');
            initializeApp();
        });

        function initializeApp() {
            console.log('üöÄ Inicializando aplicaci√≥n...');
            
            // Verificar que los elementos existan
            console.log('üìã Elementos del DOM:');
            console.log('- login-submit-btn:', document.getElementById('login-submit-btn'));
            console.log('- register-submit-btn:', document.getElementById('register-submit-btn'));

            // Initialize Lucide icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
                console.log('‚úÖ Lucide icons inicializados');
            }

            // Configuraci√≥n de la API
            const API_BASE_URL = 'http://localhost:3000/api';

            // Page navigation functions
            window.showHome = function() {
                document.getElementById('home-page').classList.remove('hidden');
                document.getElementById('login-page').classList.add('hidden');
                document.getElementById('register-page').classList.add('hidden');
            }

            window.showLogin = function() {
                document.getElementById('home-page').classList.add('hidden');
                document.getElementById('login-page').classList.remove('hidden');
                document.getElementById('register-page').classList.add('hidden');
            }

            window.showRegister = function() {
                document.getElementById('home-page').classList.add('hidden');
                document.getElementById('login-page').classList.add('hidden');
                document.getElementById('register-page').classList.remove('hidden');
            }

            // Authentication service
            const Auth = {
                isAuthenticated: false,
                user: null,

                async login(email, password) {
                    try {
                        console.log('üåê Enviando request de login...');
                        
                        const response = await fetch(`${API_BASE_URL}/users/login`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ email, password }),
                        });

                        console.log('üì® Response status:', response.status);
                        
                        const data = await response.json();
                        console.log('üì¶ Response data:', data);

                        if (!response.ok) {
                            throw new Error(data.message || 'Error en el servidor');
                        }

                        if (data.success) {
                            this.isAuthenticated = true;
                            this.user = data.data;
                            
                            const roleMapping = {
                                'Administrador': 'administrador',
                                'Instructor': 'instructor', 
                                'Aprendiz': 'estudiante',
                                'Vigilante': 'guardia',
                                'Visitante': 'visitante'
                            };
                            
                            this.user.role = roleMapping[this.user.NombreRol] || 'estudiante';
                            this.user.initials = this.getInitials(this.user.NombreCompleto);
                            this.user.name = this.user.NombreCompleto;

                            localStorage.setItem('auth', JSON.stringify({ 
                                isAuthenticated: true, 
                                user: this.user 
                            }));
                            
                            console.log('üîë Usuario almacenado en localStorage');
                            return this.user;
                        } else {
                            throw new Error(data.message || 'Credenciales incorrectas');
                        }
                    } catch (error) {
                        console.error('üí• Error en login:', error);
                        throw error;
                    }
                },

                async register(userData) {
                    try {
                        console.log('üåê Enviando request de registro...');
                        console.log('üì¶ Datos de registro:', userData);
                        
                        const response = await fetch(`${API_BASE_URL}/users`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(userData),
                        });

                        console.log('üì® Response status:', response.status);
                        
                        const data = await response.json();
                        console.log('üì¶ Response data:', data);

                        if (!response.ok) {
                            throw new Error(data.message || 'Error en el servidor');
                        }

                        if (data.success) {
                            console.log('‚úÖ Registro exitoso, ID:', data.data.id);
                            return data.data;
                        } else {
                            throw new Error(data.message || 'Error en el registro');
                        }
                    } catch (error) {
                        console.error('üí• Error en registro:', error);
                        throw error;
                    }
                },

                logout() {
                    this.isAuthenticated = false;
                    this.user = null;
                    localStorage.removeItem('auth');
                    showHome();
                    initUI();
                },

                checkAuth() {
                    const auth = localStorage.getItem('auth');
                    if (auth) {
                        const { isAuthenticated, user } = JSON.parse(auth);
                        this.isAuthenticated = isAuthenticated;
                        this.user = user;
                    }
                    return this.isAuthenticated;
                },

                getInitials(name) {
                    return name
                        .split(' ')
                        .map(word => word[0])
                        .join('')
                        .toUpperCase()
                        .substring(0, 2);
                }
            };

            // DOM elements
            const loginSubmitBtn = document.getElementById('login-submit-btn');
            const registerSubmitBtn = document.getElementById('register-submit-btn');
            const loginAlert = document.getElementById('login-alert');
            const registerAlert = document.getElementById('register-alert');

            // LOGIN functionality
            if (loginSubmitBtn) {
                console.log('‚úÖ Bot√≥n de login encontrado');
                loginSubmitBtn.addEventListener('click', handleLogin);
            }

            // REGISTER functionality
            if (registerSubmitBtn) {
                console.log('‚úÖ Bot√≥n de registro encontrado');
                registerSubmitBtn.addEventListener('click', handleRegister);
            }

            async function handleLogin() {
                console.log('üéØ CLICK RECIBIDO - Iniciando proceso de login...');
                
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                if (!email || !password) {
                    showAlert(loginAlert, '‚ùå Por favor completa todos los campos', 'error');
                    return;
                }
                
                // Clear previous alerts
                loginAlert.classList.add('hidden');
                loginAlert.textContent = '';
                
                // Show loading state
                const originalText = loginSubmitBtn.textContent;
                loginSubmitBtn.textContent = 'Iniciando sesi√≥n...';
                loginSubmitBtn.disabled = true;
                
                try {
                    const user = await Auth.login(email, password);
                    showAlert(loginAlert, '‚úÖ Login exitoso! Redirigiendo...', 'success');
                    
                    setTimeout(() => {
                        console.log('üéØ Redirigiendo a admin.html');
                        window.location.href = 'admin.html';
                    }, 1500);
                    
                } catch (error) {
                    showAlert(loginAlert, `‚ùå ${error.message}`, 'error');
                    loginSubmitBtn.textContent = originalText;
                    loginSubmitBtn.disabled = false;
                }
            }

            async function handleRegister() {
                console.log('üéØ CLICK RECIBIDO - Iniciando proceso de registro...');
                
                const nombre = document.getElementById('register-nombre').value;
                const documento = document.getElementById('register-documento').value;
                const email = document.getElementById('register-email').value;
                const telefono = document.getElementById('register-telefono').value;
                const rol = document.getElementById('register-rol').value;
                const password = document.getElementById('register-password').value;
                const confirmPassword = document.getElementById('register-confirm-password').value;
                const terms = document.getElementById('terms').checked;
                
                // Validaciones
                if (!nombre || !documento || !email || !rol || !password || !confirmPassword) {
                    showAlert(registerAlert, '‚ùå Por favor completa todos los campos obligatorios', 'error');
                    return;
                }
                
                if (password !== confirmPassword) {
                    showAlert(registerAlert, '‚ùå Las contrase√±as no coinciden', 'error');
                    return;
                }
                
                if (!terms) {
                    showAlert(registerAlert, '‚ùå Debes aceptar los t√©rminos y condiciones', 'error');
                    return;
                }
                
                // Clear previous alerts
                registerAlert.classList.add('hidden');
                registerAlert.textContent = '';
                
                // Show loading state
                const originalText = registerSubmitBtn.textContent;
                registerSubmitBtn.textContent = 'Creando cuenta...';
                registerSubmitBtn.disabled = true;
                
                try {
                    const userData = {
                        IdRol: parseInt(rol),
                        NombreCompleto: nombre,
                        Documento: documento,
                        Correo: email,
                        Telefono: telefono,
                        Contrasena: password
                    };
                    
                    await Auth.register(userData);
                    showAlert(registerAlert, '‚úÖ ¬°Cuenta creada exitosamente! Redirigiendo al login...', 'success');
                    
                    setTimeout(() => {
                        showLogin();
                        // Limpiar formulario
                        document.getElementById('register-form').reset();
                        registerSubmitBtn.textContent = originalText;
                        registerSubmitBtn.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    showAlert(registerAlert, `‚ùå ${error.message}`, 'error');
                    registerSubmitBtn.textContent = originalText;
                    registerSubmitBtn.disabled = false;
                }
            }

            function showAlert(alertElement, message, type) {
                alertElement.textContent = message;
                alertElement.className = `alert alert-${type}`;
                alertElement.classList.remove('hidden');
            }

            // Initialize the UI
            function initUI() {
                if (Auth.checkAuth()) {
                    console.log('üë§ Usuario autenticado');
                    // Aqu√≠ ir√≠a la l√≥gica para mostrar el men√∫ de usuario
                } else {
                    console.log('üë§ Usuario no autenticado');
                }
            }

            // Check API connection
            async function checkAPI() {
                try {
                    const response = await fetch(`${API_BASE_URL}/health`);
                    const data = await response.json();
                    
                    if (data.status === 'OK') {
                        console.log('‚úÖ API conectada correctamente');
                    } else {
                        console.warn('‚ö†Ô∏è API no responde correctamente');
                    }
                } catch (error) {
                    console.error('‚ùå No se pudo conectar a la API:', error.message);
                }
            }

            // Initialize
            initUI();
            checkAPI();
            
            console.log('üéâ APLICACI√ìN INICIALIZADA CORRECTAMENTE');
        }
    </script>
</body>
</html>